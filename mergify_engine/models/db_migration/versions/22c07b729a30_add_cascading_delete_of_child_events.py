"""Add cascading delete of child events

Revision ID: 22c07b729a30
Revises: 58f7635fbcc5
Create Date: 2023-11-08 17:06:50.982476

"""
import alembic


revision = "22c07b729a30"
down_revision = "58f7635fbcc5"
branch_labels = None
depends_on = None


def upgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    alembic.op.drop_constraint(
        "event_action_assign_id_fkey", "event_action_assign", type_="foreignkey"
    )
    alembic.op.create_foreign_key(
        alembic.op.f("event_action_assign_id_fkey"),
        "event_action_assign",
        "event",
        ["id"],
        ["id"],
        ondelete="CASCADE",
    )
    alembic.op.drop_constraint(
        "event_action_backport_id_fkey", "event_action_backport", type_="foreignkey"
    )
    alembic.op.create_foreign_key(
        alembic.op.f("event_action_backport_id_fkey"),
        "event_action_backport",
        "event",
        ["id"],
        ["id"],
        ondelete="CASCADE",
    )
    alembic.op.drop_constraint(
        "event_action_close_id_fkey", "event_action_close", type_="foreignkey"
    )
    alembic.op.create_foreign_key(
        alembic.op.f("event_action_close_id_fkey"),
        "event_action_close",
        "event",
        ["id"],
        ["id"],
        ondelete="CASCADE",
    )
    alembic.op.drop_constraint(
        "event_action_comment_id_fkey", "event_action_comment", type_="foreignkey"
    )
    alembic.op.create_foreign_key(
        alembic.op.f("event_action_comment_id_fkey"),
        "event_action_comment",
        "event",
        ["id"],
        ["id"],
        ondelete="CASCADE",
    )
    alembic.op.drop_constraint(
        "event_action_copy_id_fkey", "event_action_copy", type_="foreignkey"
    )
    alembic.op.create_foreign_key(
        alembic.op.f("event_action_copy_id_fkey"),
        "event_action_copy",
        "event",
        ["id"],
        ["id"],
        ondelete="CASCADE",
    )
    alembic.op.drop_constraint(
        "event_action_delete_head_branch_id_fkey",
        "event_action_delete_head_branch",
        type_="foreignkey",
    )
    alembic.op.create_foreign_key(
        alembic.op.f("event_action_delete_head_branch_id_fkey"),
        "event_action_delete_head_branch",
        "event",
        ["id"],
        ["id"],
        ondelete="CASCADE",
    )
    alembic.op.drop_constraint(
        "event_action_dismiss_reviews_id_fkey",
        "event_action_dismiss_reviews",
        type_="foreignkey",
    )
    alembic.op.create_foreign_key(
        alembic.op.f("event_action_dismiss_reviews_id_fkey"),
        "event_action_dismiss_reviews",
        "event",
        ["id"],
        ["id"],
        ondelete="CASCADE",
    )
    alembic.op.drop_constraint(
        "event_action_edit_id_fkey", "event_action_edit", type_="foreignkey"
    )
    alembic.op.create_foreign_key(
        alembic.op.f("event_action_edit_id_fkey"),
        "event_action_edit",
        "event",
        ["id"],
        ["id"],
        ondelete="CASCADE",
    )
    alembic.op.drop_constraint(
        "event_action_github_actions_id_fkey",
        "event_action_github_actions",
        type_="foreignkey",
    )
    alembic.op.create_foreign_key(
        alembic.op.f("event_action_github_actions_id_fkey"),
        "event_action_github_actions",
        "event",
        ["id"],
        ["id"],
        ondelete="CASCADE",
    )
    alembic.op.drop_constraint(
        "event_action_label_id_fkey", "event_action_label", type_="foreignkey"
    )
    alembic.op.create_foreign_key(
        alembic.op.f("event_action_label_id_fkey"),
        "event_action_label",
        "event",
        ["id"],
        ["id"],
        ondelete="CASCADE",
    )
    alembic.op.drop_constraint(
        "event_action_merge_id_fkey", "event_action_merge", type_="foreignkey"
    )
    alembic.op.create_foreign_key(
        alembic.op.f("event_action_merge_id_fkey"),
        "event_action_merge",
        "event",
        ["id"],
        ["id"],
        ondelete="CASCADE",
    )
    alembic.op.drop_constraint(
        "event_action_post_check_id_fkey", "event_action_post_check", type_="foreignkey"
    )
    alembic.op.create_foreign_key(
        alembic.op.f("event_action_post_check_id_fkey"),
        "event_action_post_check",
        "event",
        ["id"],
        ["id"],
        ondelete="CASCADE",
    )
    alembic.op.drop_constraint(
        "event_action_queue_change_id_fkey",
        "event_action_queue_change",
        type_="foreignkey",
    )
    alembic.op.create_foreign_key(
        alembic.op.f("event_action_queue_change_id_fkey"),
        "event_action_queue_change",
        "event",
        ["id"],
        ["id"],
        ondelete="CASCADE",
    )
    alembic.op.drop_constraint(
        "event_action_queue_checks_end_id_fkey",
        "event_action_queue_checks_end",
        type_="foreignkey",
    )
    alembic.op.create_foreign_key(
        alembic.op.f("event_action_queue_checks_end_id_fkey"),
        "event_action_queue_checks_end",
        "event",
        ["id"],
        ["id"],
        ondelete="CASCADE",
    )
    alembic.op.drop_constraint(
        "event_action_queue_checks_start_speculative_check_pull__7f8e",
        "event_action_queue_checks_start",
        type_="foreignkey",
    )
    alembic.op.drop_constraint(
        "event_action_queue_checks_start_id_fkey",
        "event_action_queue_checks_start",
        type_="foreignkey",
    )
    alembic.op.create_foreign_key(
        alembic.op.f("event_action_queue_checks_start_id_fkey"),
        "event_action_queue_checks_start",
        "event",
        ["id"],
        ["id"],
        ondelete="CASCADE",
    )
    alembic.op.create_foreign_key(
        alembic.op.f(
            "event_action_queue_checks_start_speculative_check_pull_request_id_fkey"
        ),
        "event_action_queue_checks_start",
        "speculative_check_pull_request",
        ["speculative_check_pull_request_id"],
        ["id"],
        ondelete="CASCADE",
    )
    alembic.op.drop_constraint(
        "event_action_queue_enter_id_fkey",
        "event_action_queue_enter",
        type_="foreignkey",
    )
    alembic.op.create_foreign_key(
        alembic.op.f("event_action_queue_enter_id_fkey"),
        "event_action_queue_enter",
        "event",
        ["id"],
        ["id"],
        ondelete="CASCADE",
    )
    alembic.op.drop_constraint(
        "event_action_queue_leave_id_fkey",
        "event_action_queue_leave",
        type_="foreignkey",
    )
    alembic.op.create_foreign_key(
        alembic.op.f("event_action_queue_leave_id_fkey"),
        "event_action_queue_leave",
        "event",
        ["id"],
        ["id"],
        ondelete="CASCADE",
    )
    alembic.op.drop_constraint(
        "event_action_queue_merged_id_fkey",
        "event_action_queue_merged",
        type_="foreignkey",
    )
    alembic.op.create_foreign_key(
        alembic.op.f("event_action_queue_merged_id_fkey"),
        "event_action_queue_merged",
        "event",
        ["id"],
        ["id"],
        ondelete="CASCADE",
    )
    alembic.op.drop_constraint(
        "event_action_rebase_id_fkey", "event_action_rebase", type_="foreignkey"
    )
    alembic.op.create_foreign_key(
        alembic.op.f("event_action_rebase_id_fkey"),
        "event_action_rebase",
        "event",
        ["id"],
        ["id"],
        ondelete="CASCADE",
    )
    alembic.op.drop_constraint(
        "event_action_refresh_id_fkey", "event_action_refresh", type_="foreignkey"
    )
    alembic.op.create_foreign_key(
        alembic.op.f("event_action_refresh_id_fkey"),
        "event_action_refresh",
        "event",
        ["id"],
        ["id"],
        ondelete="CASCADE",
    )
    alembic.op.drop_constraint(
        "event_action_request_reviews_id_fkey",
        "event_action_request_reviews",
        type_="foreignkey",
    )
    alembic.op.create_foreign_key(
        alembic.op.f("event_action_request_reviews_id_fkey"),
        "event_action_request_reviews",
        "event",
        ["id"],
        ["id"],
        ondelete="CASCADE",
    )
    alembic.op.drop_constraint(
        "event_action_requeue_id_fkey", "event_action_requeue", type_="foreignkey"
    )
    alembic.op.create_foreign_key(
        alembic.op.f("event_action_requeue_id_fkey"),
        "event_action_requeue",
        "event",
        ["id"],
        ["id"],
        ondelete="CASCADE",
    )
    alembic.op.drop_constraint(
        "event_action_review_id_fkey", "event_action_review", type_="foreignkey"
    )
    alembic.op.create_foreign_key(
        alembic.op.f("event_action_review_id_fkey"),
        "event_action_review",
        "event",
        ["id"],
        ["id"],
        ondelete="CASCADE",
    )
    alembic.op.drop_constraint(
        "event_action_squash_id_fkey", "event_action_squash", type_="foreignkey"
    )
    alembic.op.create_foreign_key(
        alembic.op.f("event_action_squash_id_fkey"),
        "event_action_squash",
        "event",
        ["id"],
        ["id"],
        ondelete="CASCADE",
    )
    alembic.op.drop_constraint(
        "event_action_unqueue_id_fkey", "event_action_unqueue", type_="foreignkey"
    )
    alembic.op.create_foreign_key(
        alembic.op.f("event_action_unqueue_id_fkey"),
        "event_action_unqueue",
        "event",
        ["id"],
        ["id"],
        ondelete="CASCADE",
    )
    alembic.op.drop_constraint(
        "event_action_update_id_fkey", "event_action_update", type_="foreignkey"
    )
    alembic.op.create_foreign_key(
        alembic.op.f("event_action_update_id_fkey"),
        "event_action_update",
        "event",
        ["id"],
        ["id"],
        ondelete="CASCADE",
    )
    alembic.op.drop_constraint(
        "event_queue_freeze_create_id_fkey",
        "event_queue_freeze_create",
        type_="foreignkey",
    )
    alembic.op.create_foreign_key(
        alembic.op.f("event_queue_freeze_create_id_fkey"),
        "event_queue_freeze_create",
        "event",
        ["id"],
        ["id"],
        ondelete="CASCADE",
    )
    alembic.op.drop_constraint(
        "event_queue_freeze_delete_id_fkey",
        "event_queue_freeze_delete",
        type_="foreignkey",
    )
    alembic.op.create_foreign_key(
        alembic.op.f("event_queue_freeze_delete_id_fkey"),
        "event_queue_freeze_delete",
        "event",
        ["id"],
        ["id"],
        ondelete="CASCADE",
    )
    alembic.op.drop_constraint(
        "event_queue_freeze_update_id_fkey",
        "event_queue_freeze_update",
        type_="foreignkey",
    )
    alembic.op.create_foreign_key(
        alembic.op.f("event_queue_freeze_update_id_fkey"),
        "event_queue_freeze_update",
        "event",
        ["id"],
        ["id"],
        ondelete="CASCADE",
    )
    alembic.op.drop_constraint(
        "event_queue_pause_create_id_fkey",
        "event_queue_pause_create",
        type_="foreignkey",
    )
    alembic.op.create_foreign_key(
        alembic.op.f("event_queue_pause_create_id_fkey"),
        "event_queue_pause_create",
        "event",
        ["id"],
        ["id"],
        ondelete="CASCADE",
    )
    alembic.op.drop_constraint(
        "event_queue_pause_delete_id_fkey",
        "event_queue_pause_delete",
        type_="foreignkey",
    )
    alembic.op.create_foreign_key(
        alembic.op.f("event_queue_pause_delete_id_fkey"),
        "event_queue_pause_delete",
        "event",
        ["id"],
        ["id"],
        ondelete="CASCADE",
    )
    alembic.op.drop_constraint(
        "event_queue_pause_update_id_fkey",
        "event_queue_pause_update",
        type_="foreignkey",
    )
    alembic.op.create_foreign_key(
        alembic.op.f("event_queue_pause_update_id_fkey"),
        "event_queue_pause_update",
        "event",
        ["id"],
        ["id"],
        ondelete="CASCADE",
    )
    # ### end Alembic commands ###


def downgrade() -> None:
    # NOTE(sileht): We don't want to support downgrades as it means we will
    # drop columns. And we don't want to provide tooling that may drop data.
    # For restoring old version of the database, the only supported process is
    # to use a backup.
    pass
